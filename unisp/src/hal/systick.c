/**
 * @file systicks.c
 * @brief
 * @author raiden00
 * @date 2015-09-28
 **/

/******************************************************************************
 * project: UniSP
 * chip: STM32F334x8
 * compiler: arm-none-eabi-gcc
 *
 ******************************************************************************/

/*
  +=============================================================================+
  | includes
  +=============================================================================+
*/

#include <stdint.h>
#include <stm32f334x8.h>
#include "unisp/inc/hal/systick.h"

/*
  +=============================================================================+
  | local definitions
  +=============================================================================+
*/

/*
  +=============================================================================+
  | module variables
  +=============================================================================+
*/

/*
  +=============================================================================+
  | local functions' declarations
  +=============================================================================+
*/

/*
  +=============================================================================+
  | global functions
  +=============================================================================+
*/

/**
 * @addtogroup systick
 * @{
 */

/**
 * @brief
 * @details
 **/
void systick_init(uint32_t ticks){

    if ((ticks - 1) > SysTick_LOAD_RELOAD_Msk)  while(1);      /* Reload value impossible */

    SysTick->LOAD = ticks - 1;
    SysTick->VAL = 0;

    SysTick->CTRL &=~ SysTick_CTRL_CLKSOURCE_Msk;
    SysTick->CTRL |=  SysTick_CTRL_TICKINT_Msk;
    SysTick->CTRL |=  SysTick_CTRL_ENABLE_Msk;

//     NVIC_SetPriority(SysTick_IRQn, _);

}

/**
 * @} end of timers group
 */

/******************************************************************************
 * END OF FILE
 ******************************************************************************/
