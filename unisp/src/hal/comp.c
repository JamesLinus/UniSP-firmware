/**
 * @file comp.c
 * @brief
 * @author raiden00
 * @date 2015-09-28
 **/

/******************************************************************************
 * project: UniSP
 * chip: STM32F334x8
 * compiler: arm-none-eabi-gcc
 *
 ******************************************************************************/

/*
  +=============================================================================+
  | includes
  +=============================================================================+
*/

#include <stdint.h>
#include <stm32f334x8.h>
#include "unisp/inc/hal/comp.h"

/*
  +=============================================================================+
  | local definitions
  +=============================================================================+
*/

/*
  +=============================================================================+
  | module variables
  +=============================================================================+
*/

/*
  +=============================================================================+
  | local functions' declarations
  +=============================================================================+
*/

/*
  +=============================================================================+
  | global functions
  +=============================================================================+
*/

/**
 * @addtogroup comp
 * @{
 */

/**
 * @brief Comparator 2 configuration
 * @details DAC1_CH2 - inverting input. PA7 - noninverting input. Output low.
 **/
void comp2_init(void){

    RCC->APB2ENR |= RCC_APB2ENR_SYSCFGEN;

    COMP2->CSR |= COMP_CSR_COMPxINSEL_0 | COMP_CSR_COMPxINSEL_2; //!< DAC1_CH2 as inverting input
    //directly connected to HRTIM1 FLT1
//    COMP2->CSR |= COMP_CSR_COMPxPOL; //!< output is inverted
    COMP2->CSR |= COMP_CSR_COMPxEN; //!< enable
    COMP2->CSR |= COMP_CSR_COMPxLOCK;//!< comparator lock

}

/**
 * @} end of timers group
 */

/******************************************************************************
 * END OF FILE
 ******************************************************************************/
